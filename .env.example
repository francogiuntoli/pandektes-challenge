# Database connection string used by Prisma
DATABASE_URL=postgresql://postgres:postgres@localhost:5433/pandektes?schema=public

# Listening port
PORT=3000

# Secret used to sign JWT access tokens. Override in production.
JWT_SECRET=P4ND3K735

# Access token lifetime in seconds (optional).
JWT_ACCESS_TOKEN_TTL=3600

# Credentials for seeding a demo user (used by `prisma db seed`).
SEED_USER_EMAIL=franco@pandektes.com
SEED_USER_PASSWORD=should_hire_me
SEED_USER_SALT_ROUNDS=12

# Comma-separated list of allowed origins for CORS.
# CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# API key for your chosen OpenAI-compatible provider
# OPENAI_API_KEY=sk-xxxx

# Optional: override the default model (gpt-4o-mini). Must have structured-output capability.
# OPENAI_MODEL=gpt-4o-mini

# Prompt template for metadata extraction; {{DOCUMENT_TEXT}} will be replaced with the truncated document contents.
METADATA_EXTRACTION_PROMPT="You will receive raw, possibly noisy text from a legal document (court judgments, orders, decisions, etc.).
Extract the following fields and return exactly ONE JSON object that matches this schema:

{
  \"title\": string | null,
  \"decision_type\": string | null,      // Prefer one of: \"Judgment\", \"Order\", \"Decision\", \"Opinion\", \"Ruling\". If none fits, use a short free-text label or null.
  \"decision_date\": string | null,      // ISO 8601 date: YYYY-MM-DD. If the day or month is missing, return null.
  \"office\": string | null,             // Chamber/office/department if explicitly stated.
  \"court\": string | null,              // Full court name if present.
  \"case_number\": string | null,        // Preserve punctuation and slashes; trim whitespace.
  \"summary\": string,                   // <= 120 words, plain text.
  \"conclusion\": string,                // <= 80 words, plain text. Focus on outcome/operative part.
  \"source_url\": string | null          // Only if a URL is explicitly present in the provided text; otherwise null.
}

Extraction rules and heuristics (strict):
1) Output format:
   - Output ONLY the JSON object. No backticks, no prose, no comments.
   - Use null (not empty strings) when data is missing or uncertain.
2) Anti-hallucination:
   - Do NOT invent values not supported by the text.
   - If multiple candidates exist and none is clearly the right one, choose null.
3) Title:
   - Prefer the document's own title line (e.g., heading like \"Judgment of the Court (Grand Chamber) ...\").
   - If multilingual headings exist, prefer the language used most consistently in the body; if unclear, prefer English.
4) Decision type:
   - Identify explicit keywords (e.g., \"Judgment\", \"Order\", \"Decision\", \"Opinion\", \"Decree\", \"Ruling\").
   - If only implicit (e.g., \"It is adjudged that ...\"), pick the best-fitting label; if unsure, null.
5) Decision date:
   - Pick the date of the decision, not the hearing, registration, or publication, unless labeled as \"Date of decision.\"
   - Handle EU formats (e.g., \"13 September 2023\", \"13/09/2023\") -> normalize to YYYY-MM-DD.
   - If month/day are ambiguous or text is truncated -> null.
6) Office / Court:
   - \"office\" is the chamber/section/division (e.g., \"Grand Chamber\", \"Second Chamber\", \"Section II\", or named office).
   - \"court\" is the institution name (e.g., \"Court of Justice of X\", \"High Court of Y\"). If both appear, map accordingly.
7) Case number:
   - Prefer the most specific, final identifier (e.g., \"C-123/21\", \"Case No. 2023/45\", \"Docket 2 BvR 100/20\").
   - Strip leading labels like \"Case:\", keep the identifier as printed.
8) Summary (<= 120 words):
   - One-paragraph, neutral summary of the dispute, key issues, and legal context.
   - No quotations; no section headers; plain text only.
9) Conclusion (<= 80 words):
   - One-paragraph outcome/operative holding (e.g., dismissed/allowed, interpretation given, penalties).
   - If the conclusion is scattered, synthesize it faithfully; if not found, set to null.
10) Truncation / noise tolerance:
   - Text may contain headers/footers, page numbers, footnotes, hyphenation, or be truncated.
   - Extract conservatively: if a field cannot be confidently determined due to truncation or noise, set it to null.

Now extract using the above rules from this document text:

=== BEGIN DOCUMENT TEXT (may be truncated) ===
{{DOCUMENT_TEXT}}
=== END DOCUMENT TEXT ==="
